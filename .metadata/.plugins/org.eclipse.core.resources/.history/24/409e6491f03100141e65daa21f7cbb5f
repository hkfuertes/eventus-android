package es.hkapps.eventus.model;

import java.io.File;
import java.io.IOException;
import java.io.Serializable;
import java.net.URI;
import java.text.SimpleDateFormat;
import java.util.Date;

import android.net.Uri;
import android.os.Environment;
import android.provider.MediaStore;
import es.hkapps.eventus.api.Util;

public class Photo implements Serializable {
	private String event_key;
	private Uri file;
	private String date;
	private String username;
	
	public Photo(String event_key, Uri file, String date, String username){
		this.event_key = event_key;
		this.file = file;
		this.date = date;
		this.username = username;
	}
	public Photo(Event event, String username){
		this.date = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date());
		this.event_key = event.getKey();
		
	    this.file = Uri.fromFile(this.createImageFile());
		
		this.username = username;
	}
	
	public Uri getPhotoUri(){
		return file;
	}
	
	String mCurrentPhotoPath;

	public File createImageFile() {
	    // Create an image file name
	    String imageFileName = event_key+"_"+username+"_"+date+"_";
	    File storageDir = Environment.getExternalStoragePublicDirectory(
	            Environment.DIRECTORY_PICTURES);
	    File image = null;
		try {
			image = File.createTempFile(
			    imageFileName,  /* prefix */
			    ".jpg",         /* suffix */
			    storageDir      /* directory */
			);
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	    // Save a file: path for use with ACTION_VIEW intents
	    mCurrentPhotoPath = "file:" + image.getAbsolutePath();
	    return image;
	}
	

}
